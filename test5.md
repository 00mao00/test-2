# Linuxサーバーの保守運用とセキュリティ・監視コマンドまとめ

## ＊信頼性の高いセキュリティ情報を収集

### 目的：
サーバーを安全に運用するために、**脆弱性や攻撃情報を早期に把握**し、適切な対応をとる。

### 主な情報源：
- **JPCERT/CC**：日本のセキュリティインシデント対応機関  
　→ サイバー攻撃や脆弱性の速報、メール/サイト/Xなどで発信  
- **JVN（Japan Vulnerability Notes）**：脆弱性情報ポータル  
　→ IPAとJPCERT/CCが共同で運営  
- **IPA（情報処理推進機構）**：セキュリティ教育や人材育成も支援  
　→ メルマガや公式サイトで注意喚起情報を提供  

---

## ＊`dnf`コマンド：パッケージやアプリケーションのアップデート

| コマンド | 状況 | 説明 |
|---------|------|------|
| `dnf check-update` | アップデート前に確認したい時 | アップデート可能なパッケージを一覧表示 |
| `sudo dnf update -y` | サーバー全体のパッケージを最新にしたい時 | 一括でアップデート。セキュリティパッチも含まれる |
| `sudo dnf update httpd` | 特定のソフトだけ更新したい時 | Apacheなど個別にアップデート可能 |

**使用シーン：**  
- 月1の定期更新や脆弱性の緊急対応時  
- 商用サーバーでは、**ステージング環境で事前確認後に本番へ適用**

---

## ＊`uptime`コマンド：システムの稼働時間確認

| コマンド | 状況 |
|---------|------|
| `uptime` | 再起動されたか確認したい時や、負荷状況をざっくり見たい時 |

**表示内容：**  
- 稼働時間  
- ログイン中のユーザー数  
- 負荷（ロードアベレージ）

---

## ＊`df`コマンド：ディスク使用量の確認

| コマンド | 状況 |
|---------|------|
| `df -h` | ディスク容量不足が疑われる時（ログ肥大化など） |

**使用シーン：**  
- 「サーバが動かなくなった」「書き込みできない」時に**ストレージ満杯か確認**

---

## ＊`du`コマンド：ディレクトリ・ファイルの使用量確認

| コマンド | 状況 |
|---------|------|
| `du /var/www/html/` | Webサーバーの容量の内訳を確認したい時 |
| `du -a /var/www/html/ \| more` | ファイル単位まで詳細に確認したい時 |
| `du -s` / `-sh` | 合計サイズだけ把握したい時 |

**使用シーン：**  
- 特定ディレクトリで容量を食っている場所を探したい時（例：WordPressの画像やキャッシュ）

---

## ＊`free`コマンド：メモリの使用状況確認

| コマンド | 状況 |
|---------|------|
| `free -m` | メモリが足りているか確認したい時 |
| `free -ms 1` | 動的に変化を見たい時（1秒ごと更新） |

**使用シーン：**  
- サーバーが重い、アプリが落ちる時 → 実メモリと**スワップ使用量**を確認

---

## ＊`top`コマンド：プロセスとリソースの使用状況をリアルタイム監視

| コマンド | 状況 |
|---------|------|
| `top` | サーバーが重い時に原因調査（どのプロセスが重いか） |
| `top -u ユーザー名` | 特定ユーザーのプロセスだけ見たい時 |
| `top -d 5` | 更新頻度を変更したい時 |

**表示項目：**
- PID：プロセスID  
- USER：ユーザー名  
- %CPU / %MEM：使用率  
- TIME+：累積CPU時間  
- COMMAND：実行コマンド

---

## ＊`vmstat`コマンド：システム負荷の全体像を確認

| コマンド | 状況 |
|---------|------|
| `vmstat` | メモリ、CPU、I/Oの基本情報を一括で確認したい時 |
| `vmstat 1` | 数秒ごとの変化を見る場合 |
| `vmstat -SM` | 単位をメガバイトで見たい場合 |

**使用シーン：**  
- 負荷のボトルネックを広く浅く見たいとき  
（CPUが忙しいのか、IO待ちか、スワップが多いかなど）

---

## ＊`ps`コマンド：実行中プロセスの確認

| コマンド | 状況 |
|---------|------|
| `ps` | 現在のターミナルで実行中のプロセスを確認 |
| `ps aux` | サーバー全体の全プロセスを確認したい時（誰が何を動かしてるか） |

**使用シーン：**  
- サービスが動いているか確認  
- 不審なプロセスがないか監視

---
